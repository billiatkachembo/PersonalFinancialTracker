import{t as D,j as e}from"./index-Dyy1KlOR.js";import{r as y}from"./vendor-BgKluMRn.js";import{B as b}from"./button-DrwKho1A.js";import{I as f}from"./input-nRTx-HcG.js";import{L as p}from"./label-BuJPDLgL.js";import{T as O}from"./textarea-DLZJwJ4o.js";import{u as T,S as j,a as C,b as N,c as E,d as m,P as I}from"./Index-BH9e9aIM.js";import{u as M}from"./useLanguage-BX4Z74C8.js";import{C as B}from"./calculator-n0Lb3y7H.js";import"./Spinner-CHoRvTaw.js";const L={Education:[{value:"education-tuition",label:"🎓 Tuition"},{value:"education-books",label:"📚 Books & Supplies"},{value:"education-online",label:"🖥️ Online Courses"}],Food:[{value:"food-groceries",label:"🛒 Groceries"},{value:"food-restaurants",label:"🍽️ Restaurants"},{value:"food-coffee",label:"☕ Coffee"}],Transportation:[{value:"transport-fuel",label:"⛽ Fuel"},{value:"transport-public",label:"🚌 Public Transport"},{value:"transport-ride",label:"🚕 Ride Share"}],Healthcare:[{value:"health-doctor",label:"🩺 Doctor Visits"},{value:"health-pharmacy",label:"💊 Pharmacy"},{value:"health-insurance",label:"🛡️ Insurance"}],Entertainment:[{value:"movies",label:"🎬 Movies"},{value:"games",label:"🎮 Games"},{value:"events",label:"🎟️ Events"},{value:"music",label:"🎵 Music"}],Beauty:[{value:"beauty-salon",label:"💇 Salon"},{value:"beauty-cosmetics",label:"💄 Cosmetics"},{value:"beauty-spa",label:"🧖 Spa & Wellness"},{value:"beauty-other",label:"💅 Other Beauty"}],Social:[{value:"social-gifts",label:"🎁 Gifts"},{value:"social-donations",label:"🙏 Donations"},{value:"social-events",label:"🎉 Events & Parties"},{value:"social-other",label:"🔖 Other Social"}],Other:[{value:"other-misc",label:"🔖 Miscellaneous"}]},P=g=>{try{const x=g.replace(/[^-()\d/*+.]/g,"").match(/(\d+\.?\d*)|[+\-*/()]/g);if(!x)return NaN;const n=[],l=[],c={"+":1,"-":1,"*":2,"/":2},i=()=>{const o=l.pop(),a=n.pop(),h=n.pop();if(h===void 0||a===void 0||!o)return NaN;switch(o){case"+":n.push(h+a);break;case"-":n.push(h-a);break;case"*":n.push(h*a);break;case"/":if(a===0)throw new Error("Division by zero");n.push(h/a);break;default:return NaN}};for(const o of x)if(o==="(")l.push(o);else if(o===")"){for(;l.length>0&&l[l.length-1]!=="(";)i();l.pop()}else if(c[o]){for(;l.length>0&&c[l[l.length-1]]>=c[o];)i();l.push(o)}else n.push(parseFloat(o));for(;l.length>0;)i();return n.length===1?n[0]:NaN}catch(t){return console.error("Calculation error:",t),NaN}},Z=({onSubmit:g})=>{const[t,x]=y.useState({date:new Date().toISOString().split("T")[0],amount:0,category:"",description:"",account:"Cash",repeat:"one-time",repeatStart:"",repeatEnd:""}),[n,l]=y.useState(!1),[c,i]=y.useState(""),{toast:o}=D(),{t:a}=M(),{currencies:h,currency:S}=T(),k=[{value:"one-time",label:a("oneTime")||"One-time"},{value:"daily",label:a("daily")||"Daily"},{value:"weekly",label:a("weekly")||"Weekly"},{value:"monthly",label:a("monthly")||"Monthly"},{value:"yearly",label:a("yearly")||"Yearly"}],d=(s,r)=>{x(u=>({...u,[s]:r}))},v=s=>{if(s==="=")try{const r=c||t.amount.toString(),u=P(r);if(isNaN(u)||!isFinite(u))throw new Error("Invalid calculation");d("amount",parseFloat(u.toFixed(2))),i(""),l(!1)}catch{o({title:a("error")||"Error",description:a("invalidCalculation")||"Invalid calculation",variant:"destructive"})}else i(s==="C"?"":s==="DEL"?r=>r.slice(0,-1):r=>r+s)};y.useEffect(()=>{if(!n)return;const s=r=>{r.key>="0"&&r.key<="9"||["+","-","*","/","."].includes(r.key)?v(r.key):r.key==="Enter"?v("="):r.key==="Escape"?l(!1):r.key.toLowerCase()==="c"?v("C"):r.key==="Backspace"&&v("DEL")};return window.addEventListener("keydown",s),()=>window.removeEventListener("keydown",s)},[n,c,v]);const F=s=>{if(s.preventDefault(),!t.amount||!t.category||!t.description){o({title:a("error")||"Error",description:a("fillAllFields")||"Please fill in all required fields",variant:"destructive"});return}if(t.amount<=0){o({title:a("error")||"Error",description:a("amountGreaterThanZero")||"Amount must be greater than 0",variant:"destructive"});return}if(t.repeat!=="one-time"&&(!t.repeatStart||!t.repeatEnd)){o({title:a("error")||"Error",description:a("repeatStartEndRequired")||"Please provide both repeat start and end dates",variant:"destructive"});return}g(t),x({date:new Date().toISOString().split("T")[0],amount:0,category:"",description:"",account:"Cash",repeat:"one-time",repeatStart:"",repeatEnd:""}),i(""),o({title:a("success")||"Success",description:a("expenseAdded")||"Expense added successfully!",variant:"default"})};return e.jsxs("form",{onSubmit:F,className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(p,{htmlFor:"expense-date",children:a("date")||"Date"}),e.jsx(f,{id:"expense-date",type:"date",value:t.date,onChange:s=>d("date",s.target.value),className:"shadow-soft"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(p,{htmlFor:"expense-amount",children:[a("amount")||"Amount"," (",h[S].symbol,") *"]}),e.jsxs("div",{className:"flex relative",children:[e.jsx(f,{id:"expense-amount",type:"text",inputMode:"none",value:c||t.amount||"",readOnly:!0,onClick:()=>l(!0),placeholder:"0.00",className:"shadow-soft pr-10"}),e.jsx(b,{type:"button",variant:"ghost",size:"sm",onClick:()=>l(!n),className:"absolute right-0 top-1/2 -translate-y-1/2",children:e.jsx(B,{className:"h-6 w-7 text-muted-foreground"})})]}),n&&e.jsxs("div",{className:"absolute top-16 right-0 w-64 p-2 rounded-lg shadow-md bg-background text-foreground z-50",children:[e.jsx("div",{className:"mb-2 text-right font-mono select-none border-b-2 pb-1 border-gray-200",children:c||t.amount||"0"}),e.jsx("div",{className:"grid grid-cols-5 gap-1",children:["7","8","9","+","4","5","6","-","1","2","3","*","0",".","=","/","C","DEL"].map(s=>e.jsx(b,{type:"button",variant:"outline",size:"sm",onClick:()=>v(s),children:s},s))})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(p,{htmlFor:"expense-category",children:[a("category")," *"]}),e.jsxs(j,{value:t.category,onValueChange:s=>d("category",s),children:[e.jsx(C,{className:"shadow-soft",children:e.jsx(N,{placeholder:a("selectCategory")})}),e.jsx(E,{className:"space-y-2 p-2 max-h-[300px] overflow-auto",children:Object.entries(L).map(([s,r])=>e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-muted-foreground px-3 py-1 uppercase",children:a(s)}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:r.map(({value:u,label:w})=>e.jsx(m,{value:u,children:a(w)||w},u))})]},s))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(p,{htmlFor:"expense-account",children:a("account")||"Account"}),e.jsxs(j,{value:t.account,onValueChange:s=>d("account",s),children:[e.jsx(C,{className:"shadow-soft",children:e.jsx(N,{placeholder:a("selectAccount")||"Select account"})}),e.jsxs(E,{children:[e.jsxs(m,{value:"Cash",children:["💵 ",a("Cash")||"Cash"]}),e.jsxs(m,{value:"Bank",children:["🏦 ",a("Bank")||"Bank"]}),e.jsxs(m,{value:"Credit Card",children:["💳 ",a("Credit Card")||"Credit Card"]}),e.jsxs(m,{value:"Debit Card",children:["🏧 ",a("Debit Card")||"Debit Card"]}),e.jsxs(m,{value:"Mobile Money",children:["📱 ",a("Mobile Money")||"Mobile Money"]})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(p,{htmlFor:"expense-repeat",children:a("repeat")||"Repeat"}),e.jsxs(j,{value:t.repeat,onValueChange:s=>d("repeat",s),children:[e.jsx(C,{className:"shadow-soft",children:e.jsx(N,{placeholder:a("repeatFrequency")||"Repeat frequency"})}),e.jsx(E,{children:k.map(({value:s,label:r})=>e.jsx(m,{value:s,children:r},s))})]})]})]}),t.repeat!=="one-time"&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(p,{htmlFor:"repeat-start",children:[a("repeatStart")||"Repeat Start"," *"]}),e.jsx(f,{id:"repeat-start",type:"date",value:t.repeatStart,onChange:s=>d("repeatStart",s.target.value),className:"shadow-soft"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(p,{htmlFor:"repeat-end",children:[a("repeatEnd")||"Repeat End"," *"]}),e.jsx(f,{id:"repeat-end",type:"date",value:t.repeatEnd,onChange:s=>d("repeatEnd",s.target.value),className:"shadow-soft"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(p,{htmlFor:"expense-description",children:[a("description")||"Description"," *"]}),e.jsx(O,{id:"expense-description",value:t.description,onChange:s=>d("description",s.target.value),placeholder:a("expensePlaceholder")||"What did you spend on?",className:"shadow-soft",rows:3})]}),e.jsxs(b,{type:"submit",variant:"expense",className:"w-full",children:[e.jsx(I,{className:"h-4 w-4 mr-2"}),a("addExpense")]})]})};export{Z as ExpenseForm};

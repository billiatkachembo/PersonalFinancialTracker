import{j as e,X as A}from"./index-CsFIVyTN.js";import{r as m}from"./vendor-BgKluMRn.js";import{I as P}from"./input-BCy5uUby.js";import{B as W}from"./button-DsPSxjjs.js";import{u as Z,l as I,S as y,a as v,b as w,c as N,d as r,B as x,m as H}from"./Index-B5rmGJgG.js";import{u as R,a as C,c as D,d as b,b as T}from"./useLanguage-C7eAUMgS.js";import{ExpenseList as X}from"./ExpenseList-BR4CF0Rd.js";import{IncomeList as q}from"./IncomeList-5xXLC8hC.js";import"./Spinner-Csv4KNU-.js";import"./trash-2-DLaTgvkw.js";const se=({expenses:j,income:p,onDeleteExpense:E,onDeleteIncome:B})=>{const[n,F]=m.useState(""),[i,S]=m.useState("all"),[c,M]=m.useState("all"),[o,k]=m.useState("all"),{currency:V}=Z(),{t:a}=R(),O=m.useMemo(()=>{const s=new Set([...j.map(t=>t.category),...p.map(t=>t.category)]);return Array.from(s).sort()},[j,p]),u=m.useMemo(()=>{let s=[...j,...p];if(n){const t=n.toLowerCase();s=s.filter(l=>{var g;return l.description.toLowerCase().includes(t)||l.category.toLowerCase().includes(t)||(((g=l.account)==null?void 0:g.toLowerCase().includes(t))??!1)})}if(i!=="all"&&(s=s.filter(t=>t.category===i)),c!=="all"&&(s=s.filter(t=>t.type===c)),o!=="all"){const t=new Date;let l;switch(o){case"week":l=new Date(t.getTime()-7*24*60*60*1e3);break;case"month":l=new Date(t),l.setMonth(t.getMonth()-1),l.getDate()!==t.getDate()&&l.setDate(0);break;case"3months":l=new Date(t),l.setMonth(t.getMonth()-3),l.getDate()!==t.getDate()&&l.setDate(0);break;case"year":l=new Date(t),l.setFullYear(t.getFullYear()-1);break;default:l=new Date(0)}s=s.filter(g=>new Date(g.date)>=l)}return s.sort((t,l)=>new Date(l.date).getTime()-new Date(t.date).getTime())},[j,p,n,i,c,o]),d=u.filter(s=>s.type==="expense"),h=u.filter(s=>s.type==="income"),Y=()=>{F(""),S("all"),M("all"),k("all")},f=n!==""||i!=="all"||c!=="all"||o!=="all",L=s=>new Intl.NumberFormat("en-ZM",{style:"currency",currency:V||"ZMW",minimumFractionDigits:2}).format(s);return e.jsxs("div",{className:"space-y-6",children:[e.jsxs(C,{className:"shadow-soft",children:[e.jsx(D,{children:e.jsxs(b,{className:"flex items-center gap-2",children:[e.jsx(I,{className:"h-5 w-5","aria-hidden":"true"}),a("searchFilterTransactions")]})}),e.jsxs(T,{className:"space-y-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(I,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground","aria-hidden":"true"}),e.jsx(P,{placeholder:a("searchPlaceholder"),value:n,onChange:s=>F(s.target.value),className:"pl-10","aria-label":a("searchTransactions"),autoComplete:"off"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs(y,{value:c,onValueChange:M,"aria-label":a("filterType"),children:[e.jsx(v,{children:e.jsx(w,{placeholder:a("transactionType")})}),e.jsxs(N,{children:[e.jsx(r,{value:"all",children:a("allTypes")}),e.jsx(r,{value:"income",children:a("incomeOnly")}),e.jsx(r,{value:"expense",children:a("expensesOnly")})]})]}),e.jsxs(y,{value:i,onValueChange:S,"aria-label":a("filterCategory"),children:[e.jsx(v,{children:e.jsx(w,{placeholder:a("category")})}),e.jsxs(N,{children:[e.jsx(r,{value:"all",children:a("allCategories")}),O.map(s=>e.jsx(r,{value:s,children:a(s)},s))]})]}),e.jsxs(y,{value:o,onValueChange:k,"aria-label":a("filterDate"),children:[e.jsx(v,{children:e.jsx(w,{placeholder:a("timePeriod")})}),e.jsxs(N,{children:[e.jsx(r,{value:"all",children:a("allTime")}),e.jsx(r,{value:"week",children:a("lastWeek")}),e.jsx(r,{value:"month",children:a("lastMonth")}),e.jsx(r,{value:"3months",children:a("last3Months")}),e.jsx(r,{value:"year",children:a("lastYear")})]})]}),e.jsxs(W,{variant:"outline",onClick:Y,disabled:!f,className:"flex items-center gap-2","aria-disabled":!f,"aria-label":a("clearFilters"),children:[e.jsx(A,{className:"h-4 w-4","aria-hidden":"true"}),a("clearFilters")]})]}),f&&e.jsxs("div",{className:"flex flex-wrap gap-2","aria-live":"polite",children:[n&&e.jsxs(x,{variant:"secondary",children:[a("search"),': "',n,'"']}),c!=="all"&&e.jsxs(x,{variant:"secondary",children:[a("type"),": ",a(c)]}),i!=="all"&&e.jsxs(x,{variant:"secondary",children:[a("category"),": ",a(i)]}),o!=="all"&&e.jsxs(x,{variant:"secondary",children:[a("period"),": ",a(o)]})]})]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("div",{className:"text-sm text-muted-foreground","aria-live":"polite",children:a("foundTransactions",{total:u.length,income:h.length,expenses:d.length})}),u.length>0&&e.jsxs("div",{className:"flex gap-2 flex-wrap",children:[h.length>0&&e.jsxs(x,{variant:"secondary",className:"text-income",children:[a("income"),": ",L(h.reduce((s,t)=>s+(t.amount||0),0))]}),d.length>0&&e.jsxs(x,{variant:"secondary",className:"text-expense",children:[a("expenses"),": ",L(d.reduce((s,t)=>s+(t.amount||0),0))]})]})]}),u.length===0?e.jsxs("div",{className:"text-center py-12 text-muted-foreground",role:"status","aria-live":"polite",children:[e.jsx(H,{className:"h-12 w-12 mx-auto mb-4 opacity-50","aria-hidden":"true"}),e.jsx("p",{className:"text-lg font-medium mb-2",children:a("noTransactionsFound")}),e.jsx("p",{children:a("adjustSearchOrFilters")})]}):e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[h.length>0&&e.jsxs(C,{className:"shadow-soft",children:[e.jsx(D,{children:e.jsxs(b,{className:"text-income",children:[a("income")," (",h.length,")"]})}),e.jsx(T,{children:e.jsx(q,{income:h,onDelete:B})})]}),d.length>0&&e.jsxs(C,{className:"shadow-soft",children:[e.jsx(D,{children:e.jsxs(b,{className:"text-expense",children:[a("expenses")," (",d.length,")"]})}),e.jsx(T,{children:e.jsx(X,{expenses:d,onDelete:E})})]})]})]})};export{se as SearchExpenses};

import{j as e,X as Z}from"./index-CXfqqSNR.js";import{r as j}from"./vendor-BgKluMRn.js";import{I as H}from"./input-9izpb35h.js";import{B as R}from"./button-CH5IRsWw.js";import{u as X,l as B,S as v,a as N,b as w,c as C,d as n,B as p,m as q}from"./Index-Ck3c8dIX.js";import{u as z,a as b,c as T,d as F,b as D}from"./useLanguage-CzxK3kxw.js";import{ExpenseList as G}from"./ExpenseList-BVEFVCUm.js";import{IncomeList as J}from"./IncomeList-2O7W0hvg.js";import"./Spinner-y3XzBHul.js";import"./trash-2-N99csCay.js";const K=h=>{const l=new Date,i=new Date(l);switch(h){case"week":i.setDate(l.getDate()-7);break;case"month":i.setMonth(l.getMonth()-1);break;case"3months":i.setMonth(l.getMonth()-3);break;case"year":i.setFullYear(l.getFullYear()-1);break;case"all":return null}return i},ne=({expenses:h,income:l,onDeleteExpense:i,onDeleteIncome:V})=>{const[c,S]=j.useState(""),[o,M]=j.useState("all"),[d,L]=j.useState("all"),[m,k]=j.useState("all"),{currency:O}=X(),{t:a}=z(),Y=j.useMemo(()=>{const s=new Set([...h.map(r=>r.category),...l.map(r=>r.category)]);return Array.from(s).filter(Boolean).sort()},[h,l]),{filteredTransactions:g,filteredExpenses:x,filteredIncome:u}=j.useMemo(()=>{let s=[...h,...l];if(c){const t=c.toLowerCase();s=s.filter(f=>{var E;return f.description.toLowerCase().includes(t)||f.category.toLowerCase().includes(t)||(((E=f.account)==null?void 0:E.toLowerCase().includes(t))??!1)})}o!=="all"&&(s=s.filter(t=>t.category===o)),d!=="all"&&(s=s.filter(t=>t.type===d));const r=K(m);r&&(s=s.filter(t=>new Date(t.date)>=r)),s.sort((t,f)=>new Date(f.date).getTime()-new Date(t.date).getTime());const P=s.filter(t=>t.type==="expense"),W=s.filter(t=>t.type==="income");return{filteredTransactions:s,filteredExpenses:P,filteredIncome:W}},[h,l,c,o,d,m]),A=()=>{S(""),M("all"),L("all"),k("all")},y=c!==""||o!=="all"||d!=="all"||m!=="all",I=s=>new Intl.NumberFormat("en-ZM",{style:"currency",currency:O||"ZMW",minimumFractionDigits:2}).format(s);return e.jsxs("div",{className:"space-y-6",children:[e.jsxs(b,{className:"shadow-soft",children:[e.jsx(T,{children:e.jsxs(F,{className:"flex items-center gap-2",children:[e.jsx(B,{className:"h-5 w-5","aria-hidden":"true"}),a("searchFilterTransactions")]})}),e.jsxs(D,{className:"space-y-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(B,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground","aria-hidden":"true"}),e.jsx(H,{placeholder:a("searchPlaceholder"),value:c,onChange:s=>S(s.target.value),className:"pl-10","aria-label":a("searchTransactions"),autoComplete:"off"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs(v,{value:d,onValueChange:L,"aria-label":a("filterType"),children:[e.jsx(N,{children:e.jsx(w,{placeholder:a("transactionType")})}),e.jsxs(C,{children:[e.jsx(n,{value:"all",children:a("allTypes")}),e.jsx(n,{value:"income",children:a("incomeOnly")}),e.jsx(n,{value:"expense",children:a("expensesOnly")})]})]}),e.jsxs(v,{value:o,onValueChange:M,"aria-label":a("filterCategory"),children:[e.jsx(N,{children:e.jsx(w,{placeholder:a("category")})}),e.jsxs(C,{children:[e.jsx(n,{value:"all",children:a("allCategories")}),Y.map(s=>e.jsx(n,{value:s,children:a(s)},s))]})]}),e.jsxs(v,{value:m,onValueChange:k,"aria-label":a("filterDate"),children:[e.jsx(N,{children:e.jsx(w,{placeholder:a("timePeriod")})}),e.jsxs(C,{children:[e.jsx(n,{value:"all",children:a("allTime")}),e.jsx(n,{value:"week",children:a("lastWeek")}),e.jsx(n,{value:"month",children:a("lastMonth")}),e.jsx(n,{value:"3months",children:a("last3Months")}),e.jsx(n,{value:"year",children:a("lastYear")})]})]}),e.jsxs(R,{variant:"outline",onClick:A,disabled:!y,className:"flex items-center gap-2","aria-disabled":!y,"aria-label":a("clearFilters"),children:[e.jsx(Z,{className:"h-4 w-4","aria-hidden":"true"}),a("clearFilters")]})]}),y&&e.jsxs("div",{className:"flex flex-wrap gap-2","aria-live":"polite",children:[c&&e.jsxs(p,{variant:"secondary",children:[a("search"),': "',c,'"']}),d!=="all"&&e.jsxs(p,{variant:"secondary",children:[a("type"),": ",a(d)]}),o!=="all"&&e.jsxs(p,{variant:"secondary",children:[a("category"),": ",a(o)]}),m!=="all"&&e.jsxs(p,{variant:"secondary",children:[a("period"),": ",a(m)]})]})]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("div",{className:"text-sm text-muted-foreground","aria-live":"polite",children:a("foundTransactions",{total:g.length,income:u.length,expenses:x.length})}),g.length>0&&e.jsxs("div",{className:"flex gap-2 flex-wrap",children:[u.length>0&&e.jsxs(p,{variant:"secondary",className:"text-income",children:[a("income"),": ",I(u.reduce((s,r)=>s+(r.amount||0),0))]}),x.length>0&&e.jsxs(p,{variant:"secondary",className:"text-expense",children:[a("expenses"),": ",I(x.reduce((s,r)=>s+(r.amount||0),0))]})]})]}),g.length===0?e.jsxs("div",{className:"text-center py-12 text-muted-foreground",role:"status","aria-live":"polite",children:[e.jsx(q,{className:"h-12 w-12 mx-auto mb-4 opacity-50","aria-hidden":"true"}),e.jsx("p",{className:"text-lg font-medium mb-2",children:a("noTransactionsFound")}),e.jsx("p",{children:a("adjustSearchOrFilters")})]}):e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[u.length>0&&e.jsxs(b,{className:"shadow-soft",children:[e.jsx(T,{children:e.jsxs(F,{className:"text-income",children:[a("income")," (",u.length,")"]})}),e.jsx(D,{children:e.jsx(J,{income:u,onDelete:V})})]}),x.length>0&&e.jsxs(b,{className:"shadow-soft",children:[e.jsx(T,{children:e.jsxs(F,{className:"text-expense",children:[a("expenses")," (",x.length,")"]})}),e.jsx(D,{children:e.jsx(G,{expenses:x,onDelete:i})})]})]})]})};export{ne as SearchExpenses};
